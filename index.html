<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>sktt1ryze's oral defense ppt</title>
    
    <style>
      .tiedContainer {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tiedItem{
            flex: 1 1 150px;
            margin: 5px;
            height: 50px;
        }

        .imageText {
          display: flex;
          /* align-items: center; */
          justify-content: space-between;
        }

        .imageTextItem {
          display: flex;
          flex-wrap: wrap;
          align-content: center;
        }
    </style>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/custom.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

    <link rel="icon" href="images/sktt1ryze.jpg" />
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
        <img src="images/hust.png" alt="hust_logo" width=80 height=80 style="float: left">
        
        <a href="https://github.com/SKTT1Ryze/ppt.js">
          <img src="images/github.svg" alt="github" width="50" height="50" style="float: right;">
        </a>

				<section data-background-image="images/background2.jpeg" data-background-opacity=0.25>
          <h2>基于Linux异步I/O和协程的高性能异步编程框架设计与实现</h2>
          <h4>计算机科学与技术学院2018级 校际交流1班</h4>
          <h3 class="tiedContainer">
            <div class="tiedItem">答辩学生：车春池</div>
            <div class="tiedItem">指导老师：邵志远</div>
          </h3>
        </section>

				<section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h2>目录</h2>
          <h3 class="tiedContainer">
            <div class="tiedItem"><a href="https://sktt1ryze.github.io/ppt.js/#/2">01 研究背景和目标</a></div>
            <div class="tiedItem"><a href="https://sktt1ryze.github.io/ppt.js/#/10">02 系统设计与实现</a></div>
          </h3>
          <h3 class="tiedContainer">
            <div class="tiedItem"><a href="https://sktt1ryze.github.io/ppt.js/#/0">03 性能测试与分析</a></div>
            <div class="tiedItem"><a href="https://sktt1ryze.github.io/ppt.js/#/0">04 最终总结与展望</a></div>
          </h3>
        </section>

				<section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究背景</h4>
          <h4 style="text-align: left;">考虑一个非常通用的后端开发场景：</h4>
          <div class="imageText">
            <div class="image">
              <img src="images/tcp-server.drawio.svg" alt="tcp-server" width="1200" style="float: left;">
            </div>
            <div class="imageTextItem">
              <div style="margin-bottom: 5px;">问题一：同步I/O会阻塞线程</div>
              <div style="margin-top: 5px;">问题二：线程间切换开销大</div>
            </div>
          </div>
        </section>

				<section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究背景</h4>
          <h4 style="text-align: left;">一个解决方案：</h4>
          <div class="imageText">
            <div class="image">
              <img src="images/tcp-server-async.drawio.svg" alt="tcp-server-async" width="700" style="float: left;">
            </div>
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">同步I/O-->异步I/O</li>
                <li style="margin-top: 5px;">线程-->协程</li>
              </ol>
            </div>
          </div>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究背景</h4>
          <h4 style="text-align: left;">什么是异步I/O？</h4>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">异步I/O是一种不阻塞的I/O模型；</li>
                <li style="margin-bottom: 5px;">同步I/O在用户线程发起请求到I/O事件<br />完成之间存在阻塞现象；</li>
                <li style="margin-bottom: 5px;">
                  异步I/O在用户线程发起请求后不阻塞直接<br />返回到用户态，用户线程可以执行<br />其他任务，I/O事件完成后内核通知用户线程；
                </li>
                <li style="margin-bottom: 5px;">
                  异步I/O消除了线程阻塞现象，能降低网络<br />或存储系统的延迟。
                </li>
              </ol>
            </div>
            <div class="image">
              <img src="images/sync-vs-async.drawio.svg" alt="sync-vs-async" width="600" style="float: right;">
            </div>
          </div>
          <h3 class="fragment">Linux于5.1版本推出<strong>io_uring</strong>异步I/O接口</h3>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究背景</h4>
          <h4 style="text-align: left;">io_uring架构：</h4>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">使用共享内存来实现内核态和用户态之间的信息交换；</li>
                <li style="margin-bottom: 5px;">提交队列用来提交I/O请求；</li>
                <li style="margin-bottom: 5px;">完成队列用于收割I/O完成事件；</li>
                <li style="margin-bottom: 5px;">
                  支持无锁并发，内部通过内存屏障技术实现状态同步。
                </li>
              </ol>
            </div>
            <div class="image">
              <img src="images/io_uring.png" alt="io_uring" width="600" style="float: right;">
            </div>
          </div>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究背景</h4>
          <h4 style="text-align: left;">什么是协程？</h4>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">协程可以被理解为能挂起和恢复的函数；</li>
                <li style="margin-bottom: 5px;">
                  协程恢复时从上次挂起的地方继续执行；
                </li>
                <li style="margin-bottom: 5px;">相比线程的优势：切换开销小；</li>
                <li style="margin-bottom: 5px;">相比线程的劣势：不能利用多核CPU，<br />无法并发执行。</li>
              </ol>
            </div>
            <div class="image">
              <img src="images/coroutines.png" alt="coroutine" width="550" style="float: right;">
            </div>
          </div>
          <h5 style="text-align: right;">
            <a href="https://blog.eiler.eu/posts/20210512/">图片出处</a>
          </h5>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究背景</h4>
          <h4 style="text-align: left;">什么是异步编程框架？</h4>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">对异步I/O和协程进行封装；</li>
                <li style="margin-bottom: 5px;">向上层网络/存储应用提供简单易用的编程接口；</li>
                <li style="margin-bottom: 5px;">赋予代码异步执行的能力；</li>
                <li style="margin-bottom: 5px;">相比同步I/O和多线程框架，更加轻量和高性能。</li>
              </ol>
            </div>
            <div class="image">
              <img src="images/async-framework.drawio.svg" alt="async-framework" width="600" height="400" style="float: right;">
            </div>
          </div>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究现状</h4>
          <h4 style="text-align: left;">目前国内外关于异步编程框架的研究现状主要体现在几个开源项目上：</h4>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">Tokio；最成熟的Rust异步运行时；</li>
                <li style="margin-bottom: 5px;">Libco：微信后台C++协程库；</li>
                <li style="margin-bottom: 5px;">Goroutine：Go语言原生协程；</li>
                <li style="margin-bottom: 5px;">Node.js：跨平台的JavaScript运行时。</li>
              </ol>
            </div>
            <div class="image">
              <img src="images/tokio-libco-go-nodejs.drawio.svg" alt="tokio-libco-go-nodejs" width="600" height="400" style="float: right;">
            </div>
          </div>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <h4>研究目标</h4>
          <h4 style="text-align: left;">基于io_uring和Rust/C++语言中的协程设计并实现高性能的异步编程框架：</h4>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">功能上：提供构建异步网络/存储应用程序的基础API；</li>
                <li style="margin-bottom: 5px;">性能上：拥有比当前开源社区中主流的异步编程框架更高的性能。</li>
              </ol>
            </div>
            <div class="image">
              <img src="images/goal.drawio.svg" alt="goal" width="600" height="400" style="float: right;">
            </div>
          </div>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <div>
            <div><h4>整体架构设计</h4></div>
            <div style="padding-top: 0px; padding-bottom: 0px;">
              <img src="images/system-design.drawio.svg" alt="system-design" width="520" height="520" style="margin-top: 0px;">
            </div>
            <div>基础层负责底层封装，应用层负责提供API。</div>
          </div>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <div><h4>多核架构设计</h4></div>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">
                  参考<a href="https://helda.helsinki.fi//bitstream/handle/10138/313642/tpc_ancs19.pdf?sequence=1">Thread-Per-Core</a>架构设计；
                </li>
                <li style="margin-bottom: 5px;">为每个核创建一个io_uring实例；</li>
                <li style="margin-bottom: 5px;">在同一个io_uring实例注册的Task只能在同一个核上运行；</li>
                <li style="margin-bottom: 5px;">设计目的是减少核间数据同步和线程切换。</li>
              </ol>
            </div>
            <div class="image">
              <img src="images/multicore-design.drawio.svg" alt="multicore-design" width="520" height="520" style="float: right;">
            </div>
          </div>
        </section>
        
        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <div><h4>Task模块设计</h4></div>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">
                  基于面向对象的思想，将所有I/O操作统一抽象成Op类；
                </li>
                <li style="margin-bottom: 5px;">继承Op父类可派生出Op子类，每个Op子对象对应一个I/O操作；</li>
                <li style="margin-bottom: 5px;">一个Task由一个或多个Op子对象呈树状构成。</li>
              </ol>
            </div>
            <div class="image">
              <img src="images/op-task.drawio.svg" alt="op-task" width="600" height="600" style="float: right;">
            </div>
          </div>
        </section>

        <section data-background-image="images/background.jpg" data-background-opacity=0.25>
          <div><h4>Task模块设计</h4></div>
          <div class="imageText">
            <div class="imageTextItem">
              <ol>
                <li style="margin-bottom: 5px;">
                  Task中的每个Op子对象均为一个切换点；
                </li>
                <li style="margin-bottom: 5px;">Task运行到切换点有两种状态：就绪和等待；</li>
              </ol>
            </div>
            <div class="image">
              <img src="images/op-task.drawio.svg" alt="op-task" width="500" height="500" style="float: right;">
            </div>
          </div>
        </section>

			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
